<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="target-densitydpi=device-dpi,width=device-width,initial-scale=1,user-scalable=no" />
<meta name="author" content="Don" />
<link rel="shortcut icon" href="http://lingxi.10086.cn/favicon.ico" />
<title>AES加密demo</title>
<!-- endbuild -->
</head>

<body ontouchstart="">
  <div id="main" class="main"> 
    key:<input type="text" id="key" /> 
    message: <input type="text" id="message" /> 
    value: <input type="text" id="value" /> 
    <input type="button" value="submit" id="submit"/>
  </div>
  <script src="//cdn.bootcss.com/zepto/1.2.0/zepto.min.js"></script>
  <script type="text/javascript" src="./aes.js"></script>
  <script type="text/javascript" src="./md5.js"></script>
  <script>
    $('#submit').on('click', function () {
      var message = $('#message').val()
      var key = $('#key').val()
      $('#value').val(encryptByAes(message, key))
    });
    //aes加密
    function encryptByAes(word, secret) {
      var secretKey = CryptoJS.MD5(secret).toString().substr(8, 16);
      var secretiv = secretKey;
      var key = CryptoJS.enc.Utf8.parse(secretKey);
      var iv = key; //CryptoJS.enc.Utf8.parse(secretKey);
      var encrypted = '';
      if(typeof(word) == 'string') {
        var srcs = CryptoJS.enc.Utf8.parse(word);
        encrypted = CryptoJS.AES.encrypt(srcs, key, {
          iv: iv,
          mode: CryptoJS.mode.CBC,
          padding: CryptoJS.pad.Pkcs7
        });
      } else if(typeof(word) == 'object') { //对象格式的转成json字符串
        data = JSON.stringify(word);
        var srcs = CryptoJS.enc.Utf8.parse(data);
        encrypted = CryptoJS.AES.encrypt(srcs, key, {
          iv: iv,
          mode: CryptoJS.mode.CBC,
          padding: CryptoJS.pad.Pkcs7
        })
      }
      return encrypted.toString();
    }
  </script>
</body>
</html>